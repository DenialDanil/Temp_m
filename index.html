<script>
  // ←←←←← ТУТ ВСТАВ ТОЧНО СВОЮ АДРЕСУ БЕКЕНДУ ←←←←←
  const URL = "https://temp-stat.onrender.com/data"; // ← твоя точна адреса без / в кінці

  const chart = document.getElementById('chart');

  // Створюємо графік
  Plotly.newPlot(chart, [
    { y: [], mode: 'lines+markers', name: 'Температура °C', line: {color: '#ff4444'} },
    { y: [], mode: 'lines+markers', name: 'Вологість %', yaxis: 'y2', line: {color: '#4444ff'} }
  ], {
    title: 'Temp_stat – Живі дані з ESP32',
    yaxis: {title: '°C', color: '#ff4444'},
    yaxis2: {title: '%', overlaying: 'y', side: 'right', color: '#4444ff'},
    paper_bgcolor: '#000', plot_bgcolor: '#111', font: {color: '#0f0'}
  });

  // Оновлення кожні 5 секунд
  setInterval(async () => {
    try {
      const res = await fetch(URL + "?t=" + Date.now()); // обход кешу
      const data = await res.json();
      const time = new Date().toLocaleTimeString();

      Plotly.extendTraces(chart, {
        y: [[data.temp], [data.hum]],
        x: [[time], [time]]
      }, [0, 1]);

      // обмежуємо 50 точок
      Plotly.relayout(chart, {
        'xaxis.autorange': true,
        'yaxis.autorange': true
      });
    });
    } catch (e) {
      console.log("Помилка:", e);
    }
  }, 5000);
</script>
